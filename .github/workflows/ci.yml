name: Project Build

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
  
  # Job 1: Build Android and JVM targets on Linux
  build-android-jvm:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          # Set to 'true' to fetch the default submodules
          # Set to 'recursive' if your submodules have their own submodules
          # submodules: recursive 
          # Optional: ensure you get the latest changes
          fetch-depth: 0

      - name: Set up JDK
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'zulu'

      - name: Validate Gradle Wrapper
        uses: gradle/actions/wrapper-validation@v3

      - name: Build and Test Android/JVM
        run: |
          chmod +x build.sh
          ./build.sh
        working-directory: tools

  # Job 2: Build iOS/Apple targets on macOS
  # build-ios:
  #   runs-on: macos-latest
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4

  #     - name: Set up JDK
  #       uses: actions/setup-java@v4
  #       with:
  #         java-version: '17'
  #         distribution: 'zulu'

  #     - name: Build iOS Target
  #       uses: gradle/actions/setup-gradle@v3
  #       with:
  #         arguments: :shared:iosArm64MainBinaries # Or :shared:linkReleaseFrameworkIosArm64